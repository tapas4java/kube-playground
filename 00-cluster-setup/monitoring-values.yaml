grafana:
  defaultDatasource:
    enabled: true
  additionalDataSources:
    - name: Prometheus
      uid: prometheus
      type: prometheus
      access: proxy
      url: http://prometheus-kube-prometheus-prometheus.monitoring.svc.cluster.local:9090
      isDefault: true
    - name: Mimir
      uid: MIMIR_CLUSTER
      type: prometheus
      access: proxy
      url: http://prometheus-kube-prometheus-prometheus.monitoring.svc.cluster.local:9090
    - name: Loki
      uid: loki
      type: loki
      access: proxy
      url: http://loki.monitoring.svc.cluster.local:3100
      jsonData:
        derivedFields:
          - datasourceUid: tempo
            matcherRegex: "traceID=(\\w+)"
            name: TraceID
            url: "$${__value.raw}"
    - name: Tempo
      uid: tempo
      type: tempo
      access: proxy
      url: http://tempo.monitoring.svc.cluster.local:3200
      jsonData:
        tracesToLogs:
          datasourceUid: "loki"
          tags: ["job", "instance", "pod", "namespace"]
          mappedTags: [{ key: "service.name", value: "app" }]
          filterByTraceID: true
  dashboards:
    default:
      kubernetes-global:
        json: |
          {
            "__inputs": [
              {
                "name": "DS_MIMIR_CLUSTER",
                "label": "Mimir",
                "description": "",
                "type": "datasource",
                "pluginId": "prometheus",
                "pluginName": "Prometheus"
              },
              {
                "name": "DS_EXPRESSION",
                "label": "",
                "description": "",
                "type": "datasource",
                "pluginId": "__expr__"
              },
              {
                "name": "DS_LOKI",
                "label": "Loki",
                "description": "",
                "type": "datasource",
                "pluginId": "loki",
                "pluginName": "Loki"
              }
            ],
            "__elements": {},
            "__requires": [
              {
                "type": "datasource",
                "id": "__expr__",
                "version": "1.0.0"
              },
              {
                "type": "grafana",
                "id": "grafana",
                "name": "Grafana",
                "version": "10.4.2"
              },
              {
                "type": "datasource",
                "id": "loki",
                "name": "Loki",
                "version": "1.0.0"
              },
              {
                "type": "datasource",
                "id": "prometheus",
                "name": "Prometheus",
                "version": "1.0.0"
              },
              {
                "type": "panel",
                "id": "table",
                "name": "Table",
                "version": ""
              },
              {
                "type": "panel",
                "id": "timeseries",
                "name": "Time series",
                "version": ""
              }
            ],
            "annotations": {
              "list": [
                {
                  "builtIn": 1,
                  "datasource": {
                    "type": "datasource",
                    "uid": "grafana"
                  },
                  "enable": true,
                  "hide": true,
                  "iconColor": "rgba(0, 211, 255, 1)",
                  "name": "Annotations & Alerts",
                  "type": "dashboard"
                }
              ]
            },
            "description": "Dashboard for global overview of Kubernetes using Mimir and Loki as datasources.",
            "editable": true,
            "fiscalYearStartMonth": 0,
            "gnetId": 21173,
            "graphTooltip": 0,
            "id": null,
            "links": [],
            "liveNow": false,
            "panels": [
              {
                "datasource": {
                  "type": "prometheus",
                  "uid": "${DS_MIMIR_CLUSTER}"
                },
                "fieldConfig": {
                  "defaults": {
                    "color": {
                      "mode": "palette-classic"
                    },
                    "custom": {
                      "axisBorderShow": false,
                      "axisCenteredZero": false,
                      "axisColorMode": "text",
                      "axisLabel": "",
                      "axisPlacement": "auto",
                      "barAlignment": 0,
                      "drawStyle": "line",
                      "fillOpacity": 10,
                      "gradientMode": "none",
                      "hideFrom": {
                        "legend": false,
                        "tooltip": false,
                        "viz": false
                      },
                      "insertNulls": false,
                      "lineInterpolation": "linear",
                      "lineWidth": 1,
                      "pointSize": 3,
                      "scaleDistribution": {
                        "type": "linear"
                      },
                      "showPoints": "always",
                      "spanNulls": true,
                      "stacking": {
                        "group": "A",
                        "mode": "none"
                      },
                      "thresholdsStyle": {
                        "mode": "line+area"
                      }
                    },
                    "links": [],
                    "mappings": [],
                    "thresholds": {
                      "mode": "absolute",
                      "steps": [
                        { "color": "transparent", "value": null }
                      ]
                    },
                    "unit": "percentunit"
                  },
                  "overrides": []
                },
                "gridPos": { "h": 5, "w": 8, "x": 0, "y": 0 },
                "id": 2,
                "options": {
                  "legend": { "calcs": [], "displayMode": "list", "placement": "bottom", "showLegend": false },
                  "tooltip": { "mode": "multi", "sort": "none" }
                },
                "pluginVersion": "8.0.6",
                "targets": [
                  {
                    "datasource": { "type": "prometheus", "uid": "${DS_MIMIR_CLUSTER}" },
                    "editorMode": "code",
                    "expr": "sum (rate (container_cpu_usage_seconds_total{cluster=~\"$cluster\"}[5m])) by (namespace)",
                    "format": "time_series",
                    "interval": "",
                    "intervalFactor": 4,
                    "legendFormat": "{{Namespace}}",
                    "range": true,
                    "refId": "A"
                  }
                ],
                "title": "CPU use by namespace",
                "type": "timeseries"
              },
              {
                "datasource": {
                  "type": "prometheus",
                  "uid": "${DS_MIMIR_CLUSTER}"
                },
                "fieldConfig": {
                  "defaults": {
                    "color": {
                      "mode": "palette-classic"
                    },
                    "custom": {
                      "axisBorderShow": false,
                      "axisCenteredZero": false,
                      "axisColorMode": "text",
                      "axisLabel": "",
                      "axisPlacement": "auto",
                      "barAlignment": 0,
                      "drawStyle": "line",
                      "fillOpacity": 0,
                      "gradientMode": "none",
                      "hideFrom": {
                        "legend": false,
                        "tooltip": false,
                        "viz": false
                      },
                      "insertNulls": false,
                      "lineInterpolation": "linear",
                      "lineWidth": 1,
                      "pointSize": 3,
                      "scaleDistribution": {
                        "type": "linear"
                      },
                      "showPoints": "always",
                      "spanNulls": true,
                      "stacking": {
                        "group": "A",
                        "mode": "none"
                      },
                      "thresholdsStyle": {
                        "mode": "line+area"
                      }
                    },
                    "decimals": 2,
                    "links": [],
                    "mappings": [],
                    "thresholds": {
                      "mode": "absolute",
                      "steps": [
                        {
                          "color": "transparent",
                          "value": null
                        },
                        {
                          "color": "red",
                          "value": 60
                        }
                      ]
                    },
                    "unit": "percentunit"
                  },
                  "overrides": [
                    {
                      "matcher": {
                        "id": "byName",
                        "options": "Cluster Total"
                      },
                      "properties": [
                        {
                          "id": "color",
                          "value": {
                            "fixedColor": "#962d82",
                            "mode": "fixed"
                          }
                        },
                        {
                          "id": "custom.lineWidth",
                          "value": 2
                        }
                      ]
                    }
                  ]
                },
                "gridPos": {
                  "h": 5,
                  "w": 8,
                  "x": 8,
                  "y": 0
                },
                "id": 6,
                "options": {
                  "legend": {
                    "calcs": [],
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": false
                  },
                  "tooltip": {
                    "mode": "multi",
                    "sort": "none"
                  }
                },
                "pluginVersion": "8.0.6",
                "targets": [
                  {
                    "datasource": {
                      "type": "prometheus",
                      "uid": "${DS_MIMIR_CLUSTER}"
                    },
                    "editorMode": "code",
                    "expr": "sum (rate (container_cpu_usage_seconds_total{cluster=~\"$cluster\"}[5m])) / sum (kube_node_status_capacity{resource=\"cpu\", cluster=~\"$cluster\"})",
                    "format": "time_series",
                    "interval": "",
                    "intervalFactor": 4,
                    "legendFormat": "Cluster Total",
                    "range": true,
                    "refId": "A"
                  },
                  {
                    "datasource": {
                      "type": "prometheus",
                      "uid": "${DS_MIMIR_CLUSTER}"
                    },
                    "editorMode": "code",
                    "expr": "sum (rate (container_cpu_usage_seconds_total{cluster=~\"$cluster\"}[5m])) by (node) / (sum (kube_node_status_capacity{resource=\"cpu\",cluster=\"$cluster\"}) by (node))",
                    "format": "time_series",
                    "interval": "",
                    "intervalFactor": 4,
                    "legendFormat": "{{node}}",
                    "range": true,
                    "refId": "B"
                  }
                ],
                "title": "Container CPU use",
                "type": "timeseries"
              },
              {
                "datasource": {
                  "type": "prometheus",
                  "uid": "${DS_MIMIR_CLUSTER}"
                },
                "fieldConfig": {
                  "defaults": {
                    "color": {
                      "mode": "palette-classic"
                    },
                    "custom": {
                      "axisBorderShow": false,
                      "axisCenteredZero": false,
                      "axisColorMode": "text",
                      "axisLabel": "",
                      "axisPlacement": "auto",
                      "barAlignment": 0,
                      "drawStyle": "line",
                      "fillOpacity": 10,
                      "gradientMode": "none",
                      "hideFrom": {
                        "legend": false,
                        "tooltip": false,
                        "viz": false
                      },
                      "insertNulls": false,
                      "lineInterpolation": "linear",
                      "lineWidth": 0,
                      "pointSize": 3,
                      "scaleDistribution": {
                        "type": "linear"
                      },
                      "showPoints": "always",
                      "spanNulls": false,
                      "stacking": {
                        "group": "A",
                        "mode": "none"
                      },
                      "thresholdsStyle": {
                        "mode": "line+area"
                      }
                    },
                    "links": [],
                    "mappings": [],
                    "min": 0,
                    "thresholds": {
                      "mode": "absolute",
                      "steps": [
                        {
                          "color": "transparent",
                          "value": null
                        },
                        {
                          "color": "red",
                          "value": 80
                        }
                      ]
                    },
                    "unit": "percent"
                  },
                  "overrides": [
                    {
                      "matcher": {
                        "id": "byName",
                        "options": "AVG"
                      },
                      "properties": [
                        {
                          "id": "color",
                          "value": {
                            "fixedColor": "#962d82",
                            "mode": "fixed"
                          }
                        }
                      ]
                    },
                    {
                      "matcher": {
                        "id": "byName",
                        "options": "AVG: 192.168.0.40:9100"
                      },
                      "properties": [
                        {
                          "id": "color",
                          "value": {
                            "fixedColor": "#0a50a1",
                            "mode": "fixed"
                          }
                        }
                      ]
                    },
                    {
                      "matcher": {
                        "id": "byName",
                        "options": "AVG: 192.168.0.41:9100"
                      },
                      "properties": [
                        {
                          "id": "color",
                          "value": {
                            "fixedColor": "#962d82",
                            "mode": "fixed"
                          }
                        }
                      ]
                    },
                    {
                      "matcher": {
                        "id": "byName",
                        "options": "AVG: 192.168.0.42:9100"
                      },
                      "properties": [
                        {
                          "id": "color",
                          "value": {
                            "fixedColor": "#bf1b00",
                            "mode": "fixed"
                          }
                        }
                      ]
                    },
                    {
                      "matcher": {
                        "id": "byRegexp",
                        "options": "/AVG.*/"
                      },
                      "properties": [
                        {
                          "id": "custom.fillOpacity",
                          "value": 0
                        },
                        {
                          "id": "custom.lineWidth",
                          "value": 2
                        }
                      ]
                    }
                  ]
                },
                "gridPos": {
                  "h": 5,
                  "w": 8,
                  "x": 16,
                  "y": 0
                },
                "id": 8,
                "options": {
                  "legend": {
                    "calcs": [],
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": false
                  },
                  "tooltip": {
                    "mode": "single",
                    "sort": "none"
                  }
                },
                "pluginVersion": "8.0.6",
                "targets": [
                  {
                    "datasource": {
                      "type": "prometheus",
                      "uid": "${DS_MIMIR_CLUSTER}"
                    },
                    "editorMode": "code",
                    "expr": "100 - (avg by (instance) (irate(node_cpu_seconds_total{mode=\"idle\",cluster=\"$cluster\"}[5m])) * 100)",
                    "format": "time_series",
                    "hide": false,
                    "interval": "",
                    "intervalFactor": 5,
                    "legendFormat": "AVG: {{instance}}",
                    "range": true,
                    "refId": "A",
                    "step": 120
                  },
                  {
                    "datasource": {
                      "type": "prometheus",
                      "uid": "${DS_MIMIR_CLUSTER}"
                    },
                    "editorMode": "code",
                    "expr": "100 - (avg by (instance,cpu) (irate(node_cpu_seconds_total{mode=\"idle\",cluster=\"$cluster\"}[5m])) * 100)",
                    "format": "time_series",
                    "hide": false,
                    "interval": "",
                    "intervalFactor": 10,
                    "legendFormat": "{{cpu}}: {{instance}}",
                    "range": true,
                    "refId": "B",
                    "step": 300
                  }
                ],
                "title": "Node CPU Usage",
                "type": "timeseries"
              },
              {
                "datasource": {
                  "type": "prometheus",
                  "uid": "${DS_MIMIR_CLUSTER}"
                },
                "fieldConfig": {
                  "defaults": {
                    "color": {
                      "mode": "palette-classic"
                    },
                    "custom": {
                      "axisBorderShow": false,
                      "axisCenteredZero": false,
                      "axisColorMode": "text",
                      "axisLabel": "",
                      "axisPlacement": "auto",
                      "barAlignment": 0,
                      "drawStyle": "line",
                      "fillOpacity": 0,
                      "gradientMode": "none",
                      "hideFrom": {
                        "legend": false,
                        "tooltip": false,
                        "viz": false
                      },
                      "insertNulls": false,
                      "lineInterpolation": "linear",
                      "lineWidth": 1,
                      "pointSize": 3,
                      "scaleDistribution": {
                        "type": "linear"
                      },
                      "showPoints": "always",
                      "spanNulls": true,
                      "stacking": {
                        "group": "A",
                        "mode": "none"
                      },
                      "thresholdsStyle": {
                        "mode": "off"
                      }
                    },
                    "fieldMinMax": false,
                    "links": [],
                    "mappings": [],
                    "min": 0,
                    "thresholds": {
                      "mode": "percentage",
                      "steps": [
                        {
                          "color": "red",
                          "value": null
                        }
                      ]
                    },
                    "unit": "percentunit"
                  },
                  "overrides": []
                },
                "gridPos": {
                  "h": 4,
                  "w": 8,
                  "x": 0,
                  "y": 5
                },
                "id": 4,
                "options": {
                  "legend": {
                    "calcs": [
                      "mean",
                      "lastNotNull"
                    ],
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": false
                  },
                  "tooltip": {
                    "mode": "multi",
                    "sort": "none"
                  }
                },
                "pluginVersion": "8.0.6",
                "targets": [
                  {
                    "datasource": {
                      "type": "prometheus",
                      "uid": "${DS_MIMIR_CLUSTER}"
                    },
                    "editorMode": "code",
                    "expr": "sum (container_memory_working_set_bytes{cluster=~\"$cluster\"}) by (namespace)",
                    "format": "time_series",
                    "interval": "10s",
                    "intervalFactor": 4,
                    "legendFormat": "{{ namespace}}",
                    "metric": "network",
                    "range": true,
                    "refId": "A",
                    "step": 10
                  }
                ],
                "title": "Memory use by namespace",
                "type": "timeseries"
              },
              {
                "alert": {
                  "alertRuleTags": {},
                  "conditions": [
                    {
                      "evaluator": {
                        "params": [
                          2500000000
                        ],
                        "type": "gt"
                      },
                      "operator": {
                        "type": "and"
                      },
                      "query": {
                        "params": [
                          "A",
                          "5m",
                          "now"
                        ]
                      },
                      "reducer": {
                        "params": [],
                        "type": "avg"
                      },
                      "type": "query"
                    }
                  ],
                  "executionErrorState": "keep_state",
                  "for": "5m",
                  "frequency": "1m",
                  "handler": 1,
                  "message": "Container total memory above 2.5G",
                  "name": "Container Memory use alert",
                  "noDataState": "no_data",
                  "notifications": []
                },
                "datasource": {
                  "type": "prometheus",
                  "uid": "${DS_MIMIR_CLUSTER}"
                },
                "fieldConfig": {
                  "defaults": {
                    "color": {
                      "mode": "palette-classic"
                    },
                    "custom": {
                      "axisBorderShow": false,
                      "axisCenteredZero": false,
                      "axisColorMode": "text",
                      "axisLabel": "",
                      "axisPlacement": "auto",
                      "axisSoftMax": 128,
                      "axisSoftMin": 0,
                      "barAlignment": 0,
                      "drawStyle": "line",
                      "fillOpacity": 0,
                      "gradientMode": "none",
                      "hideFrom": {
                        "legend": false,
                        "tooltip": false,
                        "viz": false
                      },
                      "insertNulls": false,
                      "lineInterpolation": "linear",
                      "lineWidth": 1,
                      "pointSize": 3,
                      "scaleDistribution": {
                        "type": "linear"
                      },
                      "showPoints": "always",
                      "spanNulls": true,
                      "stacking": {
                        "group": "A",
                        "mode": "none"
                      },
                      "thresholdsStyle": {
                        "mode": "line+area"
                      }
                    },
                    "fieldMinMax": false,
                    "links": [],
                    "mappings": [],
                    "thresholds": {
                      "mode": "absolute",
                      "steps": [
                        {
                          "color": "transparent",
                          "value": null
                        }
                      ]
                    },
                    "unit": "bytes"
                  },
                  "overrides": [
                    {
                      "matcher": {
                        "id": "byName",
                        "options": "Cluster Total"
                      },
                      "properties": [
                        {
                          "id": "color",
                          "value": {
                            "fixedColor": "#962d82",
                            "mode": "fixed"
                          }
                        },
                        {
                          "id": "custom.lineWidth",
                          "value": 2
                        }
                      ]
                    }
                  ]
                },
                "gridPos": {
                  "h": 5,
                  "w": 8,
                  "x": 8,
                  "y": 5
                },
                "id": 5,
                "options": {
                  "legend": {
                    "calcs": [],
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": false
                  },
                  "tooltip": {
                    "mode": "multi",
                    "sort": "none"
                  }
                },
                "pluginVersion": "8.0.6",
                "targets": [
                  {
                    "datasource": {
                      "type": "prometheus",
                      "uid": "${DS_MIMIR_CLUSTER}"
                    },
                    "editorMode": "code",
                    "expr": "sum (container_memory_working_set_bytes{cluster=~\"$cluster\"})",
                    "format": "time_series",
                    "interval": "10s",
                    "intervalFactor": 4,
                    "legendFormat": "Cluster Total",
                    "range": true,
                    "refId": "A"
                  },
                  {
                    "datasource": {
                      "type": "prometheus",
                      "uid": "${DS_MIMIR_CLUSTER}"
                    },
                    "disableTextWrap": false,
                    "editorMode": "builder",
                    "expr": "sum by(container) (container_memory_working_set_bytes{cluster=~\"$cluster\"})",
                    "format": "time_series",
                    "fullMetaSearch": false,
                    "includeNullMetadata": true,
                    "interval": "10s",
                    "intervalFactor": 4,
                    "legendFormat": "{{node}}",
                    "range": true,
                    "refId": "B",
                    "useBackend": false
                  }
                ],
                "title": "Container Memory use",
                "type": "timeseries"
              },
              {
                "datasource": {
                  "type": "prometheus",
                  "uid": "${DS_MIMIR_CLUSTER}"
                },
                "fieldConfig": {
                  "defaults": {
                    "color": {
                      "mode": "palette-classic"
                    },
                    "custom": {
                      "axisBorderShow": false,
                      "axisCenteredZero": false,
                      "axisColorMode": "text",
                      "axisLabel": "",
                      "axisPlacement": "auto",
                      "barAlignment": 0,
                      "drawStyle": "line",
                      "fillOpacity": 10,
                      "gradientMode": "none",
                      "hideFrom": {
                        "legend": false,
                        "tooltip": false,
                        "viz": false
                      },
                      "insertNulls": false,
                      "lineInterpolation": "linear",
                      "lineWidth": 1,
                      "pointSize": 4,
                      "scaleDistribution": {
                        "type": "linear"
                      },
                      "showPoints": "always",
                      "spanNulls": false,
                      "stacking": {
                        "group": "A",
                        "mode": "none"
                      },
                      "thresholdsStyle": {
                        "mode": "dashed"
                      }
                    },
                    "links": [],
                    "mappings": [],
                    "thresholds": {
                      "mode": "percentage",
                      "steps": [
                        {
                          "color": "transparent",
                          "value": null
                        },
                        {
                          "color": "#EAB839",
                          "value": 80
                        },
                        {
                          "color": "red",
                          "value": 90
                        }
                      ]
                    },
                    "unit": "bytes"
                  },
                  "overrides": []
                },
                "gridPos": {
                  "h": 5,
                  "w": 8,
                  "x": 16,
                  "y": 5
                },
                "id": 10,
                "options": {
                  "legend": {
                    "calcs": [],
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": false
                  },
                  "tooltip": {
                    "mode": "multi",
                    "sort": "none"
                  }
                },
                "pluginVersion": "8.0.6",
                "targets": [
                  {
                    "datasource": {
                      "type": "prometheus",
                      "uid": "${DS_MIMIR_CLUSTER}"
                    },
                    "editorMode": "code",
                    "expr": "sum(node_memory_MemTotal_bytes{cluster=~\"$cluster\"} - node_memory_MemFree_bytes{cluster=~\"$cluster\"} - node_memory_Cached_bytes{cluster=~\"$cluster\"} - node_memory_Buffers_bytes{cluster=~\"$cluster\"} - node_memory_Slab_bytes{cluster=~\"$cluster\"}) by (instance )",
                    "format": "time_series",
                    "interval": "",
                    "intervalFactor": 10,
                    "legendFormat": "{{instance}}",
                    "metric": "memo",
                    "range": true,
                    "refId": "A",
                    "step": 60,
                    "target": ""
                  },
                  {
                    "datasource": {
                      "type": "prometheus",
                      "uid": "${DS_MIMIR_CLUSTER}"
                    },
                    "disableTextWrap": false,
                    "editorMode": "builder",
                    "exemplar": true,
                    "expr": "sum by(node) (kube_node_status_capacity{cluster=\"$cluster\", resource=\"memory\"})",
                    "fullMetaSearch": false,
                    "hide": false,
                    "includeNullMetadata": true,
                    "instant": false,
                    "legendFormat": "__auto",
                    "range": true,
                    "refId": "B",
                    "useBackend": false
                  },
                  {
                    "datasource": {
                      "type": "__expr__",
                      "uid": "${DS_EXPRESSION}"
                    },
                    "expression": "$A-$B",
                    "hide": false,
                    "refId": "C",
                    "type": "math"
                  }
                ],
                "title": "Node Memory Usage",
                "type": "timeseries"
              },
              {
                "datasource": {
                  "type": "loki",
                  "uid": "${DS_LOKI}"
                },
                "fieldConfig": {
                  "defaults": {
                    "color": {
                      "mode": "palette-classic"
                    },
                    "custom": {
                      "axisBorderShow": false,
                      "axisCenteredZero": false,
                      "axisColorMode": "text",
                      "axisLabel": "",
                      "axisPlacement": "auto",
                      "barAlignment": 0,
                      "drawStyle": "bars",
                      "fillOpacity": 0,
                      "gradientMode": "none",
                      "hideFrom": {
                        "legend": false,
                        "tooltip": false,
                        "viz": false
                      },
                      "insertNulls": false,
                      "lineInterpolation": "linear",
                      "lineWidth": 1,
                      "pointSize": 4,
                      "scaleDistribution": {
                        "type": "linear"
                      },
                      "showPoints": "never",
                      "spanNulls": true,
                      "stacking": {
                        "group": "A",
                        "mode": "none"
                      },
                      "thresholdsStyle": {
                        "mode": "off"
                      }
                    },
                    "links": [],
                    "mappings": [],
                    "thresholds": {
                      "mode": "absolute",
                      "steps": [
                        {
                          "color": "green",
                          "value": null
                        },
                        {
                          "color": "red",
                          "value": 80
                        }
                      ]
                    },
                    "unit": "none"
                  },
                  "overrides": []
                },
                "gridPos": {
                  "h": 4,
                  "w": 8,
                  "x": 0,
                  "y": 10
                },
                "id": 12,
                "interval": "1m",
                "options": {
                  "legend": {
                    "calcs": [],
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": false
                  },
                  "tooltip": {
                    "mode": "multi",
                    "sort": "none"
                  }
                },
                "pluginVersion": "8.0.6",
                "targets": [
                  {
                    "datasource": {
                      "type": "loki",
                      "uid": "${DS_LOKI}"
                    },
                    "editorMode": "code",
                    "expr": "sum(count_over_time({cluster=\"$cluster\", stream=~\"std.+\"}[1m])) by (namespace)",
                    "instant": false,
                    "interval": "",
                    "intervalFactor": 5,
                    "legendFormat": "{{namespace}}",
                    "queryType": "range",
                    "range": true,
                    "refId": "A"
                  }
                ],
                "title": "Loki Messages by namespace",
                "type": "timeseries"
              },
              {
                "datasource": {
                  "type": "loki",
                  "uid": "${DS_LOKI}"
                },
                "fieldConfig": {
                  "defaults": {
                    "color": {
                      "mode": "palette-classic"
                    },
                    "custom": {
                      "axisBorderShow": false,
                      "axisCenteredZero": false,
                      "axisColorMode": "text",
                      "axisLabel": "",
                      "axisPlacement": "auto",
                      "barAlignment": 0,
                      "drawStyle": "bars",
                      "fillOpacity": 100,
                      "gradientMode": "none",
                      "hideFrom": {
                        "legend": false,
                        "tooltip": false,
                        "viz": false
                      },
                      "insertNulls": false,
                      "lineInterpolation": "linear",
                      "lineWidth": 1,
                      "pointSize": 5,
                      "scaleDistribution": {
                        "type": "linear"
                      },
                      "showPoints": "never",
                      "spanNulls": true,
                      "stacking": {
                        "group": "A",
                        "mode": "normal"
                      },
                      "thresholdsStyle": {
                        "mode": "off"
                      }
                    },
                    "links": [],
                    "mappings": [],
                    "thresholds": {
                      "mode": "absolute",
                      "steps": [
                        {
                          "color": "green",
                          "value": null
                        },
                        {
                          "color": "red",
                          "value": 80
                        }
                      ]
                    },
                    "unit": "short"
                  },
                  "overrides": [
                    {
                      "matcher": {
                        "id": "byName",
                        "options": "\"Cron\""
                      },
                      "properties": [
                        {
                          "id": "color",
                          "value": {
                            "fixedColor": "#64B0C8",
                            "mode": "fixed"
                          }
                        }
                      ]
                    },
                    {
                      "matcher": {
                        "id": "byName",
                        "options": "\"Error\""
                      },
                      "properties": [
                        {
                          "id": "color",
                          "value": {
                            "fixedColor": "#BF1B00",
                            "mode": "fixed"
                          }
                        }
                      ]
                    },
                    {
                      "matcher": {
                        "id": "byName",
                        "options": "\"Exception\""
                      },
                      "properties": [
                        {
                          "id": "color",
                          "value": {
                            "fixedColor": "#AEA2E0",
                            "mode": "fixed"
                          }
                        }
                      ]
                    },
                    {
                      "matcher": {
                        "id": "byName",
                        "options": "\"Fatal\""
                      },
                      "properties": [
                        {
                          "id": "color",
                          "value": {
                            "fixedColor": "#890F02",
                            "mode": "fixed"
                          }
                        }
                      ]
                    },
                    {
                      "matcher": {
                        "id": "byName",
                        "options": "\"Info\""
                      },
                      "properties": [
                        {
                          "id": "color",
                          "value": {
                            "fixedColor": "#B7DBAB",
                            "mode": "fixed"
                          }
                        }
                      ]
                    },
                    {
                      "matcher": {
                        "id": "byName",
                        "options": "\"Std error\""
                      },
                      "properties": [
                        {
                          "id": "color",
                          "value": {
                            "fixedColor": "#E24D42",
                            "mode": "fixed"
                          }
                        }
                      ]
                    },
                    {
                      "matcher": {
                        "id": "byName",
                        "options": "\"Std output\""
                      },
                      "properties": [
                        {
                          "id": "color",
                          "value": {
                            "fixedColor": "#BADFF4",
                            "mode": "fixed"
                          }
                        }
                      ]
                    },
                    {
                      "matcher": {
                        "id": "byName",
                        "options": "stderr"
                      },
                      "properties": [
                        {
                          "id": "color",
                          "value": {
                            "fixedColor": "light-red",
                            "mode": "fixed"
                          }
                        }
                      ]
                    },
                    {
                      "matcher": {
                        "id": "byName",
                        "options": "stdout"
                      },
                      "properties": [
                        {
                          "id": "color",
                          "value": {
                            "fixedColor": "super-light-blue",
                            "mode": "fixed"
                          }
                        }
                      ]
                    }
                  ]
                },
                "gridPos": {
                  "h": 4,
                  "w": 8,
                  "x": 8,
                  "y": 10
                },
                "id": 14,
                "interval": "1m",
                "options": {
                  "legend": {
                    "calcs": [],
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": false
                  },
                  "tooltip": {
                    "mode": "multi",
                    "sort": "none"
                  }
                },
                "pluginVersion": "8.0.6",
                "targets": [
                  {
                    "datasource": {
                      "type": "loki",
                      "uid": "${DS_LOKI}"
                    },
                    "editorMode": "code",
                    "expr": "sum(count_over_time({stream=~\"std.+\",cluster=\"$cluster\"}[1m])) by (stream)",
                    "interval": "",
                    "intervalFactor": 5,
                    "legendFormat": "{{stream}}",
                    "queryType": "range",
                    "refId": "A"
                  }
                ],
                "title": "Loki messages by Log Stream",
                "type": "timeseries"
              },
              {
                "datasource": {
                  "type": "prometheus",
                  "uid": "${DS_MIMIR_CLUSTER}"
                },
                "fieldConfig": {
                  "defaults": {
                    "color": {
                      "mode": "palette-classic"
                    },
                    "custom": {
                      "axisBorderShow": false,
                      "axisCenteredZero": false,
                      "axisColorMode": "text",
                      "axisLabel": "",
                      "axisPlacement": "auto",
                      "barAlignment": 0,
                      "drawStyle": "line",
                      "fillOpacity": 0,
                      "gradientMode": "none",
                      "hideFrom": {
                        "legend": false,
                        "tooltip": false,
                        "viz": false
                      },
                      "insertNulls": false,
                      "lineInterpolation": "linear",
                      "lineWidth": 1,
                      "pointSize": 3,
                      "scaleDistribution": {
                        "type": "linear"
                      },
                      "showPoints": "always",
                      "spanNulls": true,
                      "stacking": {
                        "group": "A",
                        "mode": "none"
                      },
                      "thresholdsStyle": {
                        "mode": "off"
                      }
                    },
                    "fieldMinMax": false,
                    "links": [],
                    "mappings": [],
                    "min": 0,
                    "thresholds": {
                      "mode": "percentage",
                      "steps": [
                        {
                          "color": "red",
                          "value": null
                        }
                      ]
                    },
                    "unit": "percentunit"
                  },
                  "overrides": []
                },
                "gridPos": {
                  "h": 4,
                  "w": 8,
                  "x": 16,
                  "y": 10
                },
                "id": 16,
                "options": {
                  "legend": {
                    "calcs": [],
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": false
                  },
                  "tooltip": {
                    "mode": "multi",
                    "sort": "none"
                  }
                },
                "pluginVersion": "8.0.6",
                "targets": [
                  {
                    "datasource": {
                      "type": "prometheus",
                      "uid": "${DS_MIMIR_CLUSTER}"
                    },
                    "editorMode": "code",
                    "expr": "min by (instance)(node_filesystem_free_bytes{fstype=~\"xfs|ext4\",cluster=\"$cluster\"} / node_filesystem_size_bytes{fstype=~\"xfs|ext4\"})",
                    "format": "time_series",
                    "intervalFactor": 5,
                    "legendFormat": "{{instance}}",
                    "range": true,
                    "refId": "A"
                  }
                ],
                "title": "Node Disk free space",
                "type": "timeseries"
              },
              {
                "datasource": {
                  "type": "loki",
                  "uid": "${DS_LOKI}"
                },
                "fieldConfig": {
                  "defaults": {
                    "color": {
                      "mode": "thresholds"
                    },
                    "custom": {
                      "align": "auto",
                      "cellOptions": {
                        "type": "auto"
                      },
                      "inspect": false
                    },
                    "mappings": [],
                    "thresholds": {
                      "mode": "absolute",
                      "steps": [
                        {
                          "color": "green",
                          "value": null
                        },
                        {
                          "color": "red",
                          "value": 80
                        }
                      ]
                    }
                  },
                  "overrides": []
                },
                "gridPos": {
                  "h": 16,
                  "w": 24,
                  "x": 0,
                  "y": 14
                },
                "id": 17,
                "options": {
                  "cellHeight": "sm",
                  "footer": {
                    "countRows": false,
                    "fields": "",
                    "reducer": [
                      "sum"
                    ],
                    "show": false
                  },
                  "showHeader": true
                },
                "pluginVersion": "10.4.2",
                "targets": [
                  {
                    "datasource": {
                      "type": "loki",
                      "uid": "${DS_LOKI}"
                    },
                    "editorMode": "builder",
                    "expr": "{cluster=\"$cluster\"} |= ``",
                    "queryType": "range",
                    "refId": "A"
                  }
                ],
                "title": "Panel Title",
                "type": "table"
              }
            ],
            "refresh": "5s",
            "schemaVersion": 39,
            "tags": ["alerts"],
            "templating": { "list": [] },
            "time": { "from": "now-3h", "to": "now" },
            "timepicker": {},
            "timezone": "",
            "title": "Kubernetes General Dashboard (mimir+loki)",
            "uid": "vDUOZebiz",
            "version": 1,
            "weekStart": ""
          }
      shopping-cart:
        json: |
          {
            "__inputs": [
              { "name": "DS_PROMETHEUS", "label": "Prometheus", "description": "", "type": "datasource", "pluginId": "prometheus", "pluginName": "Prometheus" },
              { "name": "DS_LOKI", "label": "Loki", "description": "", "type": "datasource", "pluginId": "loki", "pluginName": "Loki" },
              { "name": "DS_TEMPO", "label": "Tempo", "description": "", "type": "datasource", "pluginId": "tempo", "pluginName": "Tempo" }
            ],
            "__requires": [],
            "annotations": { "list": [] },
            "editable": true,
            "gnetId": null,
            "graphTooltip": 0,
            "id": null,
            "links": [],
            "panels": [],
            "schemaVersion": 35,
            "style": "dark",
            "tags": ["online-boutique"],
            "templating": { "list": [] },
            "time": { "from": "now-1h", "to": "now" },
            "timepicker": {},
            "timezone": "",
            "title": "Shopping Cart Application",
            "uid": "shop-app-1",
            "version": 1
          }
